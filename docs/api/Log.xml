<?xml version = "1.0"?>
<?xml-stylesheet type="text/xsl" href="pb_help.xsl"?>
<API>
    <MODULE name="Log" parent="Rho">
        <HELP_OVERVIEW> Use this api to control the behavior of the RhoMobile Log API as well as access it.</HELP_OVERVIEW>
        <MORE_HELP>
## Enabling the API           
This API is part of the `coreapi` extension that is included automatically.
    :::ruby
    extensions: ["coreapi"]

## JavaScript Usage
Be sure to review the [JavaScript API Usage](/guide/api_js) guide for important information about using this API in JavaScript

## Ruby Usage
Be sure to review the [Ruby API Usage](/guide/api_ruby) guide for important information about using this API in Ruby

        </MORE_HELP>
        
        <TEMPLATES>
        </TEMPLATES>

        <PROPERTIES access="STATIC" generateAccessors="true">
            
            <PROPERTY name="level" type="INTEGER">
                <DESC>The current logging level.</DESC>
                <VALUES>
                    <VALUE constName="LEVEL_TRACE" value = "0">
                        <DESC>Everything will be logged. Also see settings for controlling log size</DESC>
                    </VALUE>
                    <VALUE constName="LEVEL_INFO" value = "1">
                        <DESC>Information level logs and above will be shown</DESC>
                    </VALUE>
                    <VALUE constName="LEVEL_WARNING" value = "2">
                        <DESC>Warnings and above will only be shown</DESC>
                    </VALUE>
                    <VALUE constName="LEVEL_ERROR" value = "3">
                        <DESC>Error level log messages and above will be shown</DESC>
                    </VALUE>
                    <VALUE constName="LEVEL_FATAL" value = "4">
                        <DESC>Fatala level log messages and above will be shown</DESC>
                    </VALUE>
                </VALUES>
            </PROPERTY>

            <PROPERTY name="destination" type="ARRAY">
                <DESC>List of log destinations that are being used.</DESC>
                <VALUES>
                    <VALUE constName="DEST_FILE" value ="file">
                        <DESC>Log is written to a local file on the device (typically rholog.txt)</DESC>
                    </VALUE>
                    <VALUE constName="DEST_OUTPUT" value ="stdio">
                        <DESC>Log is written to the standard output (ex: Android ADB)</DESC>
                    </VALUE>
                    <VALUE constName="DEST_URI" value ="uri">
                        <DESC>Log is written to a remote logger</DESC>
                    </VALUE>
                </VALUES>
            </PROPERTY>

            <PROPERTY name="includeCategories" type="STRING" default="*">
                <DESC>Comma-separated list of included log categories. Set to '*' to log all categories. ex: myCat1, myCat2</DESC>
            </PROPERTY>

            <PROPERTY name="excludeCategories" type="STRING" default="">
                <DESC>Comma-separated list of excluded log categories. ex: myCat1, myCat2</DESC>
            </PROPERTY>

            <PROPERTY name="fileSize" type="INTEGER" default="0">
                <DESC>Maximum log file size in bytes, set 0 to unlimited size; when limit is reached, log wraps to beginning of file</DESC>
            </PROPERTY>

            <PROPERTY name="filePath" type="STRING" default="rholog.txt">
                <DESC>Path to the log file including file name. The path is relative to the platform specific application root or start if from '/' if you wish to store elsewhere ('/mnt/sdcard/myapp.log'). </DESC>
            </PROPERTY>

            <PROPERTY name="memoryPeriod" type="INTEGER" default="0">
                <PLATFORM>WM, Win32, Android, iOS</PLATFORM>
                <DESC>Enables the logging of memory usage in the system; specifies the time interval in milliseconds at which memory logs will be generated periodically.</DESC>
            </PROPERTY>

            <PROPERTY name="netTrace" type="BOOLEAN" default="false">
                <DESC>Turn on local http server traces. Please note that this parameter will not take an effect in case of remote server app.</DESC>
                <PLATFORM>Android, iOS, WP8</PLATFORM>
            </PROPERTY>

            <PROPERTY name="skipPost" type="BOOLEAN" default="false">
                <DESC>Skip http package body from log(for security reasons). Please note that this parameter will not take an effect in case of remote server app (Shared runtime for WM/CE), no log will appear in this case. </DESC>
            </PROPERTY>

            <PROPERTY name="excludeFilter" type="STRING" default="">
                <DESC>Define exclude parameters log filter(for security reasons) - parameter names separated by comma.</DESC>
            </PROPERTY>

            <PROPERTY name="destinationURI" type="STRING" default="">
                <DESC>Log server URI where log will be posted by using Rho::Log.sendLogFile or from the log view. Log server source code is open and available at http://github.com/rhomobile/rhologs, so you can deploy your own logserver. URI format: 'http://host:port[/path][?log_name=appName]'.</DESC>
            </PROPERTY>

        </PROPERTIES>

        <METHODS  access="STATIC">
            <ALIASES>
            </ALIASES>

            <METHOD name="trace">
                <DESC>Log message at the Trace level.</DESC>

                <PARAMS>
                    <PARAM name="message" type="STRING">
                        <DESC>Log message.</DESC>
                    </PARAM>
                    <PARAM name="category" type="STRING" default="APP">
                        <DESC>Log category.</DESC>
                    </PARAM>

                </PARAMS>
            </METHOD>

            <METHOD name="info">
                <DESC>Log message at the Info level.</DESC>

                <PARAMS>
                    <PARAM name="message" type="STRING">
                        <DESC>Log message.</DESC>
                    </PARAM>
                    <PARAM name="category" type="STRING" default="APP">
                        <DESC>Log category.</DESC>
                    </PARAM>

                </PARAMS>
            </METHOD>

            <METHOD name="warning">
                <DESC>Log message at the Warning level.</DESC>

                <PARAMS>
                    <PARAM name="message" type="STRING">
                        <DESC>Log message.</DESC>
                    </PARAM>
                    <PARAM name="category" type="STRING" default="APP">
                        <DESC>Log category.</DESC>
                    </PARAM>

                </PARAMS>
            </METHOD>

            <METHOD name="error">
                <DESC>Log message at the Error level.</DESC>

                <PARAMS>
                    <PARAM name="message" type="STRING">
                        <DESC>Log message.</DESC>
                    </PARAM>
                    <PARAM name="category" type="STRING" default="APP">
                        <DESC>Log category.</DESC>
                    </PARAM>
                </PARAMS>
            </METHOD>

            <METHOD name="fatalError">
                <DESC>Log message at the FatalError level. Application will be terminated (on all platforms except iOS)</DESC>

                <PARAMS>
                    <PARAM name="message" type="STRING">
                        <DESC>Log message.</DESC>
                    </PARAM>
                    <PARAM name="category" type="STRING" default="APP">
                        <DESC>Log category.</DESC>
                    </PARAM>
                </PARAMS>
            </METHOD>

            <METHOD name="sendLogFile" hasCallback="optional">
                <DESC>Send log file to destinationURI property.</DESC>
            </METHOD>

            <METHOD name="showLog">
                <DESC>Display Log view window.</DESC>
                <PLATFORMS>WM, Win32, iOS, Android</PLATFORMS>
            </METHOD>

            <METHOD name="cleanLogFile">
                <DESC>Clean log file.</DESC>
            </METHOD>

            <METHOD name="readLogFile">
                <DESC>Read log file.</DESC>

                <PARAMS>
                    <PARAM name="limit" type="INTEGER">
                        <DESC>Maximum size of the resulting string in symbols.</DESC>
                    </PARAM>
                </PARAMS>

                <RETURN type="STRING"/>
            </METHOD>

        </METHODS>
        
        <USER_OVERVIEW>
            <!--  More conversational style with INLINE SAMPLES, written in MarkDown -->
            <![CDATA[]]>
    
        </USER_OVERVIEW>
        <VER_INTRODUCED>1.0.0</VER_INTRODUCED>
        <PLATFORM>WM, Win32, Android, iOS, WP8</PLATFORM>
        <EXAMPLES >
           <EXAMPLE title="Show log file">
               <SECTIONS>
               <SECTION>
               <DESC>
                   Show the contents of the log file in a window with controls to refresh, clear and send. Useful for debugging and when asking users to report error messages
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
Rho::Log.showLog]]>

               </CODE>
               </SECTION>
               </SECTIONS>
           </EXAMPLE>
          <EXAMPLE title="Read log file content">
               <SECTIONS>
               <SECTION>
               <DESC>
                   Retrieve the contents of the log file as a string
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
# Read at most 16384 symbols
logFileContent = Rho::Log.readLogFile 16384]]>

               </CODE>
               </SECTION>
               </SECTIONS>
           </EXAMPLE>
           <EXAMPLE title="Clean log file">
               <SECTIONS>
               <SECTION>
               <DESC>
                   Clear the contents of the log file. In this example, logFileContentBefore will contain the log up until that point, while logFileContentAfter will be empty
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
# Read log file
logFileContentBefore = Rho::Log.readLogFile 16384

# Clear log file
Rho::Log.cleanLogFile

# Read log file again - this time it will be empty
logFileContentAfter = Rho::Log.readLogFile 16384]]>

               </CODE>
               </SECTION>
               </SECTIONS>
           </EXAMPLE>
           <EXAMPLE title="Logging categories">
               <SECTIONS>
               <SECTION>
               <DESC>
                   Categories help you organize your logging messages and find related statements using tools like grep or a text editor's "search" function.
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
Rho::Log.info("Consectetuer adipiscing elit", "Lorem Ipsum")
Rho::Log.info("Foo acquired value Bar in method Baz", "Miscellaneous")]]>

               </CODE>
               </SECTION>
               <SECTION>
               <DESC>
                   The above code will result in logging statements like these:
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
Lorem Ipsum| Consectetuer adipiscing elit
Miscellaneous| Foo acquired value Bar in method Baz]]>

               </CODE>
               </SECTION>
               </SECTIONS>
           </EXAMPLE>
           <EXAMPLE title="Memory Usage">
               <SECTIONS>
               <SECTION>
               <DESC>
                   You can ask the system to automatically log memory usage information on a set interval. 
                   This can be used to debug potential memory leaks in operations where a high number of objects are touched in memory. 
               </DESC>
               <CODE lang='ruby'>
           <![CDATA[
# Request that memory usage be logged automatically by the system every second.
Rho::Log.memoryPeriod = 1000
# Perform memory-intensive operations here. Examining the log will tell us if we have a memory leak
# Once our task finishes, disable automatic memory logging
Rho::Log.memoryPeriod = 0]]>

               </CODE>
               </SECTION>
               <SECTION>
               <DESC>
                   The same API is available in Javascript
               </DESC>
               <CODE lang='javascript'>
           <![CDATA[
Rho.Log.memoryPeriod = 1000;
// Perform memory-intensive operations here. Examining the log will tell us if we have a memory leak
// Once our task finishes, disable automatic memory logging
Rho.Log.memoryPeriod = 0;]]>

               </CODE>
               </SECTION>
               </SECTIONS>
           </EXAMPLE>
       </EXAMPLES>
    </MODULE>
</API>    