# Handing local files

## Overview

A RhoMobile application typically contains two different sets of files - one comprises the code for the application and another contains assets of different types: images, data files, etc.

Files that are only needed for rendering as-is in the [WebView](../api/webview) (such as images or stylesheets) can be placed anywhere within the `public` folder and referenced in your layout or view files as appropriate.

Data files required by the application at runtime must be accessed in two steps:

* obtain the path to the file
* process the information as required

You must always use the `Application.*Folder` properties and `RhoFile.join` to construct file paths. In particular:

* do not hardcode paths such as `/sdcard/*' even if your application only runs on a single platform
* do not concatenate strings with `\` or `/` characters manually to build paths - use `RhoFile.join` instead



## Reading other files bundled with your application
The [Application API](../api/Application) allows you to read other files bundled with your application. As shown below that how to access other files bundle.

Ruby:

	:::ruby
	# Get the various app folders
	appFolder = Rho::Application.appBundleFolder
	appsBundleFolder = Rho::Application.appsBundleFolder
	databaseBlobFolder = Rho::Application.databaseBlobFolder
	publicFolder = Rho::Application.publicFolder
	userFolder = Rho::Application.userFolder


Javascript:

	:::javascript
	// Get and show the various app folders
    var appFolder = Rho.Application.appBundleFolder;
    var appsBundleFolder = Rho.Application.appsBundleFolder;
    var databaseBlobFolder = Rho.Application.databaseBlobFolder;
    var publicFolder = Rho.Application.publicFolder;
    var userFolder = Rho.Application.userFolder;
   

## Saving files from the network to the device

**NOTE: the only directory you have write rights to is `userFolder` - other folders may work on some platforms but not others; in particular, iOS restricts writing files to any folder other than `userFolder`.**

You can download any files from an external server and store it in your device. The [Network API](../api/Network) helps your application download files using the [downloadFile](../api/Network#mdownloadFile) method. For example, Enable your device network and download file as shown below.

Ruby:

	:::ruby 
	def download_file
      #Download a file to the specified filename.
      downloadfileProps = Hash.new
      downloadfileProps["url"]='http://www.google.com/images/icons/product/chrome-48.png'
      downloadfileProps["filename"] = Rho::RhoFile.join(Rho::Application.userFolder, "sample.png")
      downloadfileProps["overwriteFile"] = true
      Rho::Network.downloadFile(downloadfileProps, url_for(:action => :download_file_callback))
  	end
  
  	def download_file_callback
    	if @params["status"] == "ok"
        	Rho::Notification.showPopup({
        		:message => "Download Success. File saved to " + Rho::RhoFile.join(Rho::Application.userFolder, "sample.png"),
        		:buttons => ["OK"]
      		})
    	else
        	Rho::Notification.showPopup({
        		:message => "Download Failed",
        		:buttons => ["OK"]
      		})
    	end
  	end

Javascript:
	
	:::javascript
	function download_file_callback(params) {
  	if (params["status"] == "ok") {
			alert("Download Succeeded. File saved to "+Rho.RhoFile.join(Rho.Application.userFolder, "sample.png"));
		} else {
			alert("Download Failed");
		}
    }

    function download_file() {
      	// Download a file to the specified filename. Be careful with the overwriteFile parameter!
      	downloadfileProps = {
        	url: "http://www.google.com/images/icons/product/chrome-48.png",
        	filename: Rho.RhoFile.join(Rho.Application.userFolder, "sample.png"),
        	overwriteFile: true
      	};
      	Rho.Network.downloadFile(downloadfileProps, download_file_callback);
    }

## Exporting the database for backup purposes

The [Datebase API](../api/Database) allows your application to export the contents of the current database to zip archive. For example, open default database with help of [Application API](../api/Application) and export it . Export method can be accessed via an instance object of this class as shown below,

Ruby:

    :::ruby
    # open default database
    db = Rho::Database.new(Rho::Application.databaseFilePath("user"),"user")
    # export database
    export_path = db.export
    db.close
    Rho::Notification.showPopup({
      :message => "Export path - #{export_path}",
      :buttons => ["OK"]
    })


Javascript:

    :::javascript
    // open default database
    var db = new Rho.Database(Rho.Application.databaseFilePath('user'), 'user');
    // export database
    var db = open_db();
    var export_path = db.export();
    db.close();
    alert("Export path - " + export_path);



## Zipping and unzipping files
You can zip any files and extract zip archives. The [System API](../api/System) helps your application to zip or unzip any files. Zip archive must placed to folder where application can write files. Examples are 

Ruby:

    :::ruby
    # zip list of files
    local_path_to_zip = Rho::RhoFile.join(Rho::Application.publicFolder, "sample.zip")
    local_path_to_file = Rho::RhoFile.join(Rho::Application.publicFolder, "sample.txt")
    Rho::System.zipFile(local_path_to_zip, local_path_to_file)
    
    # unzip a file 
    local_path_to_zip = Rho::RhoFile.join(Rho::Application.publicFolder, "sample.zip")
    Rho::System.unzipFile(local_path_to_zip)


Javascript:

    :::javascript
    // zip list of files
    var local_path_to_zip = Rho.RhoFile.join(Rho.Application.publicFolder, "sample.zip");
    var local_path_to_file = Rho.RhoFile.join(Rho.Application.publicFolder, "sample.txt");
    Rho.System.zipFile(local_path_to_zip, local_path_to_file);
    
    // unzip a file 
    var local_path_to_zip = Rho.RhoFile.join(Rho.Application.publicFolder, "sample.zip");
    Rho.System.unzipFile(local_path_to_zip);

  
