<div class='tableofcontents'> </div><h1>RhoConnectClient</h1>

<h2>Overview</h2>

<p>RhoConnectClient is used for synchronization with RhoConnect applications.</p>

<h2>Enabling the API</h2>

<p>In order to use this API you must include the following extension in your <code>build.yml</code></p>

<pre name="code" class="ruby">extensions: ["rhoconnect-client"]
</pre>

<h2>JavaScript Usage</h2>

<p>Be sure to review the <a href="/guide/api_js">JavaScript API Usage</a> guide for important information about using this API in JavaScript</p>

<h2>Ruby Usage</h2>

<p>Be sure to review the <a href="/guide/api_ruby">Ruby API Usage</a> guide for important information about using this API in Ruby</p>

<h2>Methods</h2>

<h3>addObjectNotify(<span class="text-info">STRING</span> sourceName, <span class="text-info">STRING</span> object)</h3>

<p>Add the object notification by passing in an object ID.</p>

<h4>Parameters</h4>

<ul><li>sourceName : <span class='text-info'>STRING</span><p>Source name for object notification. </p></li><li>object : <span class='text-info'>STRING</span><p>Object ID to get notifications. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.addObjectNotify(<span class="text-info">STRING</span> sourceName, <span class="text-info">STRING</span> object)</code></li>
</ul>
</li>
</ul>


<h3>cleanObjectNotify()</h3>

<p>Removes callback for object notifications.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.cleanObjectNotify()</code></li>
</ul>
</li>
</ul>


<h3>clearNotification(<span class="text-info">STRING</span> sourceName)</h3>

<p>Clears the sync notification for a given source.</p>

<h4>Parameters</h4>

<ul><li>sourceName : <span class='text-info'>STRING</span><p>Source name to clear notification. Use '*' to clear notification for all models. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.clearNotification(<span class="text-info">STRING</span> sourceName)</code></li>
</ul>
</li>
</ul>


<h3>doSync(<span class="text-info">BOOLEAN</span> showStatusPopup, <span class="text-info">STRING</span> queryParams, <span class="text-info">BOOLEAN</span> syncOnlyChangedSources)</h3>

<p>Start the RhoConnectClient sync process.</p>

<h4>Parameters</h4>

<ul><li>showStatusPopup : <span class='text-info'>BOOLEAN</span> <span class='label label-info'>Optional</span><p>Set to true to show status popup. </p></li><li>queryParams : <span class='text-info'>STRING</span> <span class='label label-info'>Optional</span><p>Parameters to be passed to server. </p></li><li>syncOnlyChangedSources : <span class='text-info'>BOOLEAN</span> <span class='label label-info'>Optional</span><p>Sync only sources that have local changes. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>STRING</span></p><ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>STRING</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.doSync(<span class="text-info">BOOLEAN</span> showStatusPopup, <span class="text-info">STRING</span> queryParams, <span class="text-info">BOOLEAN</span> syncOnlyChangedSources)</code></li>
</ul>
</li>
</ul>


<h3>doSyncSource(<span class="text-info">STRING</span> sourceName, <span class="text-info">BOOLEAN</span> showStatusPopup, <span class="text-info">STRING</span> queryParams)</h3>

<p>Start RhoConnectClient sync process for a given source name.</p>

<h4>Parameters</h4>

<ul><li>sourceName : <span class='text-info'>STRING</span><p>Source name. </p></li><li>showStatusPopup : <span class='text-info'>BOOLEAN</span> <span class='label label-info'>Optional</span><p>Set to true to show status popup. </p></li><li>queryParams : <span class='text-info'>STRING</span> <span class='label label-info'>Optional</span><p>Parameters to be passed to server. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>STRING</span></p><ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>STRING</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.doSyncSource(<span class="text-info">STRING</span> sourceName, <span class="text-info">BOOLEAN</span> showStatusPopup, <span class="text-info">STRING</span> queryParams)</code></li>
</ul>
</li>
</ul>


<h3>isLoggedIn()</h3>

<p>Returns true if the RhoConnectClient currently has a user session, false if not.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>BOOLEAN</span></p><ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>BOOLEAN : True if have logged in user session, false if not.</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.isLoggedIn()</code></li>
</ul>
</li>
</ul>


<h3>isSyncing()</h3>

<p>Returns true if sync is currently in progress.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>BOOLEAN</span></p><ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>BOOLEAN : True if sync has started but not finished yet, false otherwise.</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.isSyncing()</code></li>
</ul>
</li>
</ul>


<h3>login(<span class="text-info">STRING</span> login, <span class="text-info">STRING</span> password)</h3>

<p>Authenticates the user with RhoConnect. The callback will be executed when it is finished.</p>

<h4>Parameters</h4>

<ul><li>login : <span class='text-info'>STRING</span><p>Login name. </p></li><li>password : <span class='text-info'>STRING</span><p>Password. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>INTEGER</span></p><ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>INTEGER</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.login(<span class="text-info">STRING</span> login, <span class="text-info">STRING</span> password)</code></li>
</ul>
</li>
</ul>


<h3>logout()</h3>

<p>Logout the user from the RhoConnect server. This removes the local user session.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.logout()</code></li>
</ul>
</li>
</ul>


<h3>setNotification(<span class="text-info">STRING</span> sourceName)</h3>

<p>The RhoConnectClient system uses notifications to provide information about the sync process to a Rhodes application. Notifications can be setup once for the duration of runtime or each time a sync is triggered. Once a sync is processing for a model, notifications are called with parameters containing sync process state. Your application can use this information to display different wait pages, progress bars, etc. setNotification will set notification for a model.</p>

<h4>Parameters</h4>

<ul><li>sourceName : <span class='text-info'>STRING</span><p>Source name for which notification will be enabled. Use '*' to set notification for all models. </p></li><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.setNotification(<span class="text-info">STRING</span> sourceName)</code></li>
</ul>
</li>
</ul>


<h3>setObjectNotification()</h3>

<p>The RhoConnectClient can send a notification when a specific object on the current page has been modified. This is useful if you have frequently-changing data like feeds or timelines in your application and want them to update without the user taking any action.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Callback</h4>

<p>Async Callback Returning Parameters: <span class='text-info'>OBJECT</span></p><ul><ul><li>created : <span class='text-info'>ARRAY</span><p>Array of created objects. </p></li><li>updated : <span class='text-info'>ARRAY</span><p>Array of updated objects. </p></li><li>deleted : <span class='text-info'>ARRAY</span><p>Array of deleted objects. </p></li></ul></ul></p>

<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.setObjectNotification()</code></li>
</ul>
</li>
</ul>


<h3>stopSync()</h3>

<p>Stops any sync operations currently in progress.</p>

<h4>Parameters</h4>

<ul><li>callback : <span class='text-info'>CallBackHandler</span></li></ul>


<h4>Returns</h4>

<p>Synchronous Return:</p>

<ul>
<li>Void</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h4>Method Access:</h4>

<ul>
<li>Class Method: This method can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.stopSync()</code></li>
</ul>
</li>
</ul>


<h2>Properties</h2>

<h3>pageSize</h3>

<h4>Type</h4>

<p><span class='text-info'>INTEGER</span></p>

<h4>Description</h4>

<p>Page size for RhoConnectClient. Default size is 2000.</p>

<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.pageSize</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h3>pollInterval</h3>

<h4>Type</h4>

<p><span class='text-info'>INTEGER</span></p>

<h4>Description</h4>

<p>Sync poll interval in seconds. Setting this to 0 will disable polling-based sync. Sync process will be triggered automatically according to this setting.</p>

<h4>Params</h4>

<p><strong>Default:</strong> 60</p>


<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.pollInterval</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h3>showStatusPopup</h3>

<h4>Type</h4>

<p><span class='text-info'>BOOLEAN</span></p>

<h4>Description</h4>

<p>Enable or disable show status popup.</p>

<h4>Params</h4>

<p><strong>Default:</strong> true</p>


<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.showStatusPopup</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h3>sslVerifyPeer</h3>

<h4>Type</h4>

<p><span class='text-info'>BOOLEAN</span></p>

<h4>Description</h4>

<p>Enable or disable verification of RhoConnect ssl certificates, true by default.</p>

<h4>Params</h4>

<p><strong>Default:</strong> true</p>


<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.sslVerifyPeer</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h3>syncServer</h3>

<h4>Type</h4>

<p><span class='text-info'>STRING</span></p>

<h4>Description</h4>

<p>Sync server URL.</p>

<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.syncServer</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h3>userName</h3>

<h4>Type</h4>

<p><span class='text-info'>STRING</span> <span class='label'>Read Only</span></p>

<h4>Description</h4>

<p>Current username of the RhoConnectClient session if isLoggedIn is true, otherwise returns the last logged in username.</p>

<h4>Access</h4>

<ul>
<li>Class: This property can only be accessed via the API class object.

<ul>
<li><code>EB.RhoConnectClient.userName</code></li>
</ul>
</li>
</ul>


<h4>Platforms</h4>

<ul>
<li>Android</li>
<li>Windows Mobile</li>
</ul>


<h2>Remarks</h2>

<h3>Notification Callback Parameters</h3>

<p>When the notification is called, it will receive a variable called @params, just like a normal Rhodes controller action.</p>

<h2>Common Parameters</h2>

<p>These parameters are included in all notifications.</p>

<ul>
<li>source_id &ndash; The id of the current model that is synchronizing.</li>
<li>source_name &ndash; Name of the model (i.e. &ldquo;Product&rdquo;)</li>
<li>sync_type &ndash; Type of sync used for this model: &ldquo;incremental&rdquo; or &ldquo;bulk&rdquo;</li>
<li>status &ndash; Status of the current sync process. See below for the possible values:</li>
</ul>


<p>In the following sections we cover the different status values and parameters available with each status.</p>

<h3>status: &ldquo;in_progress&rdquo; &ndash; incremental sync progress</h3>

<ul>
<li>total_count &ndash; Total number of records that exist for this RhoConnect source.</li>
<li>processed_count &ndash; Number of records included in the sync page.</li>
<li>cumulative_count &ndash; Number of records the SyncEngine has processed so far for this source.</li>
</ul>


<h3>status: &ldquo;in_progress&rdquo; &ndash; bulk sync progress</h3>

<ul>
<li><p>bulk_status &ndash; The state of the bulk sync process:</p>

<ul>
<li>start &ndash; Bulk sync has started for a specific partition</li>
<li>download &ndash; Bulk sync file download has started</li>
<li>change_db &ndash; New bulk sync database change has started</li>
<li>blobs &ndash; Bulk sync blob files have started to download</li>
<li>ok &ndash; Current partition has completed</li>
<li>complete &ndash; All partitions have completed</li>
</ul>
</li>
<li><p>partition &ndash; Current bulk sync partition.</p></li>
</ul>


<h3>status: &ldquo;error&rdquo;</h3>

<ul>
<li>error_code &ndash; HTTP response code of the RhoConnect server error: 401, 500, 404, etc.</li>
<li>error_message &ndash; Response body (if any)</li>
<li>server_errors &ndash; Hash of Type objects of RhoConnect adapter error (if exists):

<ul>
<li>login-error &ndash; An error in adapter login method</li>
<li>query-error &ndash; An error in adapter query method</li>
<li>create-error &ndash; An error in adapter create method</li>
<li>update-error &ndash; An error in adapter update method</li>
<li>delete-error &ndash; An error in adapter delete method</li>
<li>logoff-error &ndash; An error in adapter logoff method</li>
</ul>
</li>
</ul>


<p>Each error contains a &lsquo;message&rsquo; key with the error message.</p>

<p>Ruby Example:</p>

<pre name="code" class="ruby">@params["server_errors"]["query-error"]["message"] 
#=&gt; "Error connecting to backend server: http://rhostore.herokuapp.com"
</pre>

<p>JavaScript Example:</p>

<pre name="code" class="javascript">params.server_errors["query-error"].message
//=&gt; "Error connecting to backend server: http://rhostore.herokuapp.com"
</pre>

<h4>Handling &lsquo;create-error&rsquo;</h4>

<p>&ldquo;create-error&rdquo; is a unique situation that needs to be handled in your sync callback. See <code>RhoConnectClient.onSyncCreateError()</code> for more details.</p>

<h3>status: &ldquo;complete&rdquo;</h3>

<p>This status returns only when the sync run is complete (all partitions are done synchronizing).</p>

<h3>status: &ldquo;schema-changed&rdquo;</h3>

<p>This is present if a FixedSchema model has changed during the current sync run. A new bulk sync run should be triggered (by setting bulksyncState) and the user should be alerted in the UI.</p>

<h3>Backround Sync on iOS</h3>

<p>On iOS, if the application is backgrounded, it will be suspended. This also means if a current sync is in progress, it will immediately terminate. To prevent this behavior, set &lsquo;finish_sync_in_background&rsquo; to &lsquo;1&rsquo; in rhoconfig.txt. When set to &lsquo;1&rsquo;, the RhoConnectClient will attempt to finish synchronization before the application fully suspends.</p>
